{{- if and (not .Values.certificates.existingSecret) (.Values.certificates.create) }}
# hardcoding for the challenge
# i would usually opt to use the Kubernetes Secret Store CSI driver (https://secrets-store-csi-driver.sigs.k8s.io/)
# in combination with AWS Secrets Manager (https://github.com/aws/secrets-store-csi-driver-provider-aws)
# this will inject the pods with secrets directly from AWS Secrets Manager given the right IAM permissions on EKS
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "replica-count-manager.fullname" . }}-server-certificates
  labels:
    {{- include "replica-count-manager.labels" . | nindent 4 }}
type: Opaque
data:
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZuVENDQTRXZ0F3SUJBZ0lVSkQvTDh6dHpHdjRyYkZ2ekdqZHZ1Qk5sbi9jd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1hqRUxNQWtHQTFVRUJoTUNRVlV4R0RBV0JnTlZCQWdNRDA1bGR5QlRiM1YwYUNCWFlXeGxjekVTTUJBRwpBMVVFQ2d3SlkyRnNkbWx1WW5WcE1RMHdDd1lEVlFRTERBUnliMjkwTVJJd0VBWURWUVFEREFsc2IyTmhiR2h2CmMzUXdIaGNOTWpJd056RTBNRE16TmpJMFdoY05Nakl3T0RFek1ETXpOakkwV2pCZU1Rc3dDUVlEVlFRR0V3SkIKVlRFWU1CWUdBMVVFQ0F3UFRtVjNJRk52ZFhSb0lGZGhiR1Z6TVJJd0VBWURWUVFLREFsallXeDJhVzVpZFdreApEVEFMQmdOVkJBc01CSEp2YjNReEVqQVFCZ05WQkFNTUNXeHZZMkZzYUc5emREQ0NBaUl3RFFZSktvWklodmNOCkFRRUJCUUFEZ2dJUEFEQ0NBZ29DZ2dJQkFML24yZ1cySS9KQm5icndUVDRXMFJndjNTTC9aVXBkMUdtano2L0EKbU9jVzlWL3kranl1bi92R1UxUUkrMTNSQlAzTUozQlJiQ0NnbWVuVXJLNnFBc3F4TXUzVWhnZG1NTFpnNzlPOApId3gwS0ozSjNLbklhRjBLUFEyN2pWR2xDN2hBMVNEeFIybitjUVBFTTIvV2d1S0NEUWhDT2lDYkxEbkpndjhsCkFVd1E1MzZKbTdOZmVtblptaFMrNXEwNGdVaFBNUGJUMENweDFZSDBvcWZkN1NRZUkydm1hd0g1YmhzbGJteDYKTGVRQU0reFRWVDcyVVZWenl6ZGdjRERFbnI2K3c2a3lBRnlqaDQwQzkrT2lGb1J0ZlJOQUppbVJXVTJoM0VINQpGcFhGUkViZXhTSVFZRXhnZDB6dmsxNFpXUjUzWDlmYnV0aGJ0aE03aEo0RzYwaC9hMUZEcDFlZXhtaVdCd3VOCjl6RzlCWnR0RTRYWmNNeWpyNnhJcGxrU3UzMVBqSmFYNnBycG5qdElYZDhoSG5oSHRYcGgrSFp2N2Q5ZXRzby8KOFh6MlZEaW1obmRCS1ROK3RxOUl1K1VUMlZMOXl5LzdnWEVGSGUxR3FJSUsrNXRwaGlXU0dNQU5RWDZmM2twNgpXbGhZQ3ZrWW9tVFdzSThqL29udDNEUmdYS0h3c29VR3RsUThyOGFzSXYxWDJNR2g3ZGs2YXlveUFqek9NcFhQClFYaXJtcUpCSE8xUEo3a2ovUEY3Rmppakc4Mi96WFdtWDdueFBBdWNUWVdFL0tLbm1RTmp5RmlCc050VnBMOFkKNmtTOWZRMG5RRW5mMGdXQlhUNGt3MTJ1Q1FaQnc2bkwwUjUzZFBhbzNIZ3FoRXkzVEJaZFREd1dzS04wZFdrbgo0eS9EQWdNQkFBR2pVekJSTUIwR0ExVWREZ1FXQkJTMWVmWG40WFdYQkRFSDZZcSt6WGVaT0JZRmt6QWZCZ05WCkhTTUVHREFXZ0JTMWVmWG40WFdYQkRFSDZZcSt6WGVaT0JZRmt6QVBCZ05WSFJNQkFmOEVCVEFEQVFIL01BMEcKQ1NxR1NJYjNEUUVCQ3dVQUE0SUNBUUFkRHRjU0MySDhubFZCNnVNQVdGSU1HUDNPREpnWFlsUC9WdlVHcUdhZAp1bktlVzZ0Qnd1UGpiQWhLZUhGcHMyay9rM3RCSlUrQjZFZXJwdHo0UnRZc3VNNXBQbUV2TEFDNUVPb1g3ekpBClNGMG0ySVU0UjUxdTUxNDUzdkNDVHhlVkZZV1RScndMeTl2NVByd1psYTRRcmdHZmptdml5eTc1d1I0ZGMrbG0KMlY2Qnp6U0h6ZjhPNk83UkZBcGJsT2pOYVZ0N1JGYXVrNmw4VnlLTTBRWG5CRmJ4ZVRON1QyWTRSSDFwTVlTTAo5bjJaZ0JQZUFKaVFaUFhiOVdORVo4VFZhNHNRVFA2dmFZOUNrUSt6NHJxZUFIcVNGN1hoNHIxRmtPdE1pcVJVCmVvOGs0MGN1TXkra1BOb3ZvMzJrL2phNTE1STAzTUVUMUZ2R2hzZ1lUNjFjSTFEWjdIT1VTNFBpbTNnR1cxcVAKL3VpSnpjOUkzYzhXM0cyakNhRTZPSU9EQm0yTHZSVEpkTnl0YzJTejk2Q1pLWis4Z2RCdTJIdE10UUF0ZWtHcgpDUEJoZmhlbHc1QUEvNjl0SFpGY3JWZW1YWFNaTUx0bTgrYm9zTjJvd2ZQdzhUSWtQSTRjWnlzbkJMakJtMDc5CjRxZUd6eE5JWG5OK3d1UHIzNmpJNUlQWXVsTFVDMzJpSW9qd3lFT3laT0xnWjhHZVRhUnN1YTA4cndvbTVEaUcKMUNLRVJDQlBzMmNsUzhjT0d2RGZjR1o0Wmt5VnNkQTJ0Z1k3SUhvMGFUaGt4ZmVDbWpsVGNUVlF2ZU4yLzgzSQpIL1Nsc292RWxJZldLNjlKZjBVZ2ZmSnN3VnhJRElFSzU5M2xFNnEvNVEvWnBlSk1tMkdYRGdySmIvcW1qcG5XCkR3PT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
  server.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVaRENDQWt5Z0F3SUJBZ0lVSHJMdFE2OUtXY0tHYzRhRlBWSm1oOTJsQThZd0RRWUpLb1pJaHZjTkFRRUwKQlFBd1hqRUxNQWtHQTFVRUJoTUNRVlV4R0RBV0JnTlZCQWdNRDA1bGR5QlRiM1YwYUNCWFlXeGxjekVTTUJBRwpBMVVFQ2d3SlkyRnNkbWx1WW5WcE1RMHdDd1lEVlFRTERBUnliMjkwTVJJd0VBWURWUVFEREFsc2IyTmhiR2h2CmMzUXdIaGNOTWpJd056RTBNRE16TmpJMFdoY05Nakl3T0RFek1ETXpOakkwV2pCZ01Rc3dDUVlEVlFRR0V3SkIKVlRFWU1CWUdBMVVFQ0F3UFRtVjNJRk52ZFhSb0lGZGhiR1Z6TVJJd0VBWURWUVFLREFsallXeDJhVzVpZFdreApEekFOQmdOVkJBc01Cbk5sY25abGNqRVNNQkFHQTFVRUF3d0piRzlqWVd4b2IzTjBNSUlCSWpBTkJna3Foa2lHCjl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUE1bG5uR1hUS3hNV2JyUklOa3BueExIVlJKSEFISTNIT1ZKKzcKVGlzZXl3c2xDQXhjNFJ5MmZGYUgyNDl2NFZXL1czSXY1aGhIWFFXL1Qzb0NXcyt2MXJlZkdKOHZHbG1kVkgwVgo3NGJ6Tm5NT1M4K2lubi9VWk04N0VBY3E0a25kNGdSd0tLTUdCdlZyOXVBL1daMzJ2c3EzWU5JS25veVV2ZUdvCkNRaW9mdXpySlN3c2RMbGpjTm00bXptdE05MWMwZHREZUtUMVpBL2xPTFRrUFNIN1YxRUVMN3hKWjhoUUhmS2sKaklUT3k3WDR4RDZOeUMrbmlRL21aK2c4eVUyWFU1bGtoRjBLR0lGT1JxTytWT1duUE9qM3J0QUxGVU1CM1pnQgpPdTZ2YXlDeisrTTlTVzlRRE1ueHhtTVBLcFZBOHFDem53Z1hKbmNUT3dwb2NHU0RoUUlEQVFBQm94Z3dGakFVCkJnTlZIUkVFRFRBTGdnbHNiMk5oYkdodmMzUXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnSUJBR1o0Sm1zUktUTUsKbkZVVGt4ejBsR3dZV2IyRFAwWGUwVzJSQTQ3TmpHNmJRMHJ5TWttZms0MUxEbXE0MVBYRS8zTE84bFVxaHFxZgpaamhsWXJySEsvSk12WFdLNU1nVENxSDlEQUlCb082RDNJT1Blb0d5VmhvVkpjcDk5VDlKbjI2YmRZQmxHaTRPCmRwblkxcnpNWWFrYUVZaXVtR3M5dmpST3p5TC90b1NXMGdnSjlMUXIwSGZ6dWxyTXZJK21nRnFPbDMrRXdLTzQKUE5BSkMydk1WQ1I4MVNINWZtMThNTW5VQThDN0U1c2FUTWpCZ2crMFp3NjRIeVpXQmpIOFlyR1BPbkZTL296RAplcUdCMitGSnJLdDkzUUpKQk5yUXNaU29yKzZtV3ZQcW5Hcms0NnJnUWg1TkgvYVl0UzNtNGg1WE8yRDBxSG1zCndjaVFqMFU4VlBUN0JoWjR4dGFyQ0ZIODVMVytvS2xBOEIzbkFaTmlRZzFrcGpCLzVSNzB4L1lrTUFFTGRyUS8KaFBNUjdTOFNlcmMxVE9KWnU3SitUMmRCWUlhN09Bc3Jrd1MrU2N5cWdpQk82VkRScVhsd3B5bXdVU3RUMDVHTAppdG1MNm9vRzhDRTM1YkhncWZmbVd3UDBUOUZHOFBPZTl4OExZWUFxMDFNdkdKbkdFaTYvM3dkMGRQS0pBQXAyCkpvVjJFODhwYTQ3alovNUdOaitpa0xIUGpHcXpsVHlXNHJ5MzRMVEZIQk90djFBQXRFcE82eEpPRUpqOGM5QkcKSW1oVHVkU3M3TFUvNTQrVkdCcSs5UkpsRnFkZXI1eVV6UnAwWXRrbUFYRXZLYUdKVWkrMXRVejljOW83dlBpbwpJWHNpc2ZGZmJpQnA1YW9WU2x5ZU9WSVJ2MUEvMWhNMAotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
  server.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcFFJQkFBS0NBUUVBNWxubkdYVEt4TVdiclJJTmtwbnhMSFZSSkhBSEkzSE9WSis3VGlzZXl3c2xDQXhjCjRSeTJmRmFIMjQ5djRWVy9XM0l2NWhoSFhRVy9UM29DV3MrdjFyZWZHSjh2R2xtZFZIMFY3NGJ6Tm5NT1M4K2kKbm4vVVpNODdFQWNxNGtuZDRnUndLS01HQnZWcjl1QS9XWjMydnNxM1lOSUtub3lVdmVHb0NRaW9mdXpySlN3cwpkTGxqY05tNG16bXRNOTFjMGR0RGVLVDFaQS9sT0xUa1BTSDdWMUVFTDd4Slo4aFFIZktraklUT3k3WDR4RDZOCnlDK25pUS9tWitnOHlVMlhVNWxraEYwS0dJRk9ScU8rVk9XblBPajNydEFMRlVNQjNaZ0JPdTZ2YXlDeisrTTkKU1c5UURNbnh4bU1QS3BWQThxQ3pud2dYSm5jVE93cG9jR1NEaFFJREFRQUJBb0lCQVFESm45K2NkSklYY2pBMQphUnZnT2tiVGQweXk3Q3dUWmtZSDVGaDZyMXVndGZ5UDh1SkpXR3lTb05zQjM2YzZRV2ZoankxRjVmSnhCZHJTCm9pVDFmOXlWd052TkhXaUpVKzlXU0xhdWxoekVpQ2ozU3FNNHdRTVR5aUFVZzNHUjZMNENXNGdneWJFNDNoREcKWXJxUW9xZWJrS3k2WHA5VThCQXh0QmIwOFZNcTVHUUxBVHpGamRHOVNmK0dGUlladk5KbmEyb1FXWTNtWmVMSApERE9tUkJ3REc1WUg2TjZrdVFlMEF5M1ViV281bXFJc3BxZERqdkdqdEVzd08rcUxzYnpleEFvRmFKYUpUZ0JJCkdpL2N5R0U5akV3YnJJOUwwcDhYcVUrc1hUS0c2RjE3SnVPTzdGNnFDTnlRQ256V2FrTFppU1VTa0FnK2ZKREQKdXVSUE96bUJBb0dCQVBxbEJVS1AwSHd5UExPNWhweXpkaTdNL1QzNGpqS1lDSUVlcW1zV0o4Uk1BTkpWanRwNwoxU1ZLRFEvc3lMUVlTTU4vY09jd2dCNE8vWk5xTEphNHNoVCtueVczWHBvbUZrQWpsQWNaNmJSVms1UGtGbHVzCm40NUJCVE5rZi9mNzBsTEJWZWNaNVpNdjQxVTN0ZDB3aDhhU0prRDVxOFV4bnJ6ZlY0Q2RlL21KQW9HQkFPdEYKNFlLaHkrODF4MEF1bVRjc0FqdHhHMndKZlRjVC9LTzMzWXhkM3J0M1BkL21wRzhYMURHdGhiYUJ1eE13cFo0egpHLyt4eGh6ekJWRFl2L2xiNXIrS1haVUlOaXNJc1poUHY4TDdITTJvZEt6Ujg3U01VRnhGTVFCNUk4UDNOY3dmClJqVGVKL0YrbUxkbXJVZlNmOEVEaStUMjZxSUswT0VGMW1TY01vY2RBb0dCQU9ieDJwRGtOblBaVGpsRHZ4YnYKL1B0T2dpRHh2d1E3TmNyVFdLOW5NS2tjWnIxbmZFTXdTc3NiR2tJTUtUcFlEZU9rcjRFMkhUYVZGVzBaTFpDTApDZnR5U1czVk1lUFRLRGxkRHU0a0lFUzdmVW1OcGxRK0VKNWdwc3dkMUJQSkFwaWg3K2NLNDQvbFZoQ1ZUb3RLClJqRGZSVVFsU1BKZnNDWFRuS3F6Y1NJUkFvR0JBS2tzM2FTR1hWTkw4MU9HYm12S3ZHd3J2OUVtM1ovK1Fqc2oKV2k2MXpSUTJBUXNBR1JzOUlqcjZrRnlVMm9WSkJMNUYrQXNidE41YUxXZGVCR1QxSFc1N3V5RVAvNHRnTy92TwoxSkFLNjBKQ3NHc1lxVW9aWHl1S0lWczZ3R29JVituSVR6NXl4SHdWVVJFSHh2QVBRQWYxV2VHeFh6UlgzSzBCCitwRHI5RFZOQW9HQUpuTGYwaVY5eXFyTytHSW1zNDBLQWdMcEtPelVva2J5SUdTMWZibW8wQ2JEOEZHZ1IydHoKTFpHRFNuWGFBbFh4MGVCOXlLR3EyT2NPVUVUNzlEVndWQUtaMktNSHpJQndVdjBrUExBc2k0cmV5NmpwNkdubApkYXZRelhjc0xxVTFiNXAyYk4zMytoa3lXNUhSUnRxaldvam1pbnhNT21JM3hEdHlDMWJkK0M0PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
{{- end }}
